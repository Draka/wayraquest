<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
        <link rel="icon" type="image/png" href="img/common/favicon.png">
        <meta property="og:title" content="Wayra Quest">
        <meta property="og:type" content="website">
        <meta property="og:url" content="http://ec2-75-101-168-206.compute-1.amazonaws.com/quest/client/">
        <meta property="og:image" content="http://ec2-75-101-168-206.compute-1.amazonaws.com/quest/client/img/common/promo.png">
        <meta property="og:site_name" content="Wayra Quest">
        <meta property="og:description" content="Wayra Quest, un recorrido virtual por la academia Wayra basado en BrowserQuest">
        <link rel="stylesheet" href="css/main.css" type="text/css">
        <link rel="stylesheet" href="css/achievements.css" type="text/css">
        <script src="js/lib/modernizr.js" type="text/javascript"></script>
        <!--[if lt IE 9]>
                <link rel="stylesheet" href="css/ie.css" type="text/css">
                <script src="js/lib/css3-mediaqueries.js" type="text/javascript"></script>
                <script type="text/javascript">
                document.getElementById('parchment').className = ('error');
                </script>
        <![endif]-->
        <script src="js/detect.js" type="text/javascript"></script>
        <title>Wayra Quest</title>

        <style type="text/css"> 
            #map-canvas {
                width: 600px;
                height: 400px;
                padding: 0, auto;
            }
            #map {
                border: 2px solid #000;
                background-color: #FFF;
                padding: 0, auto;
                position: absolute;
            }
            #map h2{
                text-align: center;
            }
        </style> 
        <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"> 
        </script> 
        <script type="text/javascript"> 
            var map;
            var infowindow;
            var e;
            var directionsDisplay;
            var marker;
 
            function enterToWayra(){
                $('#setMap').hide();
                $('#parchment').show();
            }
            
 
            function initialize() {
                //$('#setMap').hide();
                var mapDiv = document.getElementById('map-canvas');
                infowindow = new google.maps.InfoWindow();
                map = new google.maps.Map(mapDiv, {
                    center: new google.maps.LatLng(4.690656,-74.070719),
                    zoom: 16,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                });
                
                e = new google.maps.LatLng(4.689835,-74.070938);
                if (marker) {
                    marker.setPosition(e);
                } else {
                    marker = new google.maps.Marker({
                        position: e,
                        map: map});
                }
                
                var onMarkerClick = function() {
                    var marker = this;
                    infowindow.setContent('<div onclick="enterToWayra()" style="cursor: pointer;text-align:center;font-size:80%">Entra a las instalaciones virtuales de Wayra<br/>[[ENTRAR]]</div>');
                    infowindow.open(map, marker);
                };

                infowindow.setContent('<div onclick="enterToWayra()" style="cursor: pointer;text-align:center;font-size:80%">Entra a las instalaciones virtuales de Wayra<br/>[[ENTRAR]]</div>');
                infowindow.open(map, marker);
                
                google.maps.event.addListener(marker, 'click', onMarkerClick);
            }
            // Load the map
            google.maps.event.addDomListener(window, 'load', initialize);
        </script> 

    </head>
    <!--[if lt IE 9]>
    <body class="intro upscaled">
    <![endif]-->
    <body class="intro">

        <noscript>
        <div class="alert">
            You need to enable JavaScript to play.
        </div>
        </noscript>
        <a id="moztab" class="clickable" target="_blank" href="http://www.mozilla.org/"></a>
        <div id="intro">
            <h1 id="logo">
                <span id="logosparks">

                </span>
            </h1>
            <article id="portrait">
                <p>
                    Por favor, rote su dispositivo en modo paisaje
                </p>
                <div id="tilt"></div>
            </article>
            <div id="setMap">
                <div id="map"> 
                    <h2> 
                        Seleccione una área a explorar
                    </h2> 
                    <div id="map-canvas"></div>
                    <h2 style="color: #F00000;cursor: pointer;" onclick="enterToWayra()"> 
                        [[ CLICK PARA ENTRAR ]]
                    </h2>
                </div>
            </div> 
            <section id="parchment" class="createcharacter" style="display:none;">
                <div class="parchment-left"></div>
                <div class="parchment-middle">
                    <article id="createcharacter">
                        <h1>
                            <span class="left-ornament"></span>
                            Basado en BrowserQuest
                            <span class="right-ornament"></span>
                        </h1>
                        <div id="character" class="disabled">
                            <div></div>
                        </div>
                        <form action="none" method="get" accept-charset="utf-8">
                            <div id="auth-status">
                                <div id="auth-loggedout">
                                    <div class="fb-login-button">Inicia con Facebook</div>
                                </div>
                                <div id="auth-loggedin" style="display:none">
                                    Hola, <span id="auth-displayname"></span>  
                                    (<a href="#" id="auth-logoutlink">logout</a>)
                                </div>
                            </div>
                            <input type="text" id="nameinput" class="stroke" name="player-name" placeholder="Nombre de tu personaje" maxlength="15">
                        </form>
                        <div class="play button disabled">
                            <div></div>
                            <img src="img/common/spinner.gif" alt="">
                        </div>
                        <div class="ribbon">
                            <div class="top"></div>
                            <div class="bottom"></div>
                        </div>
                    </article>
                    <article id="loadcharacter">
                        <h1>
                            <span class="left-ornament"></span>
                            Cargar personaje
                            <span class="right-ornament"></span>
                        </h1>
                        <div class="ribbon">
                            <div class="top"></div>
                            <div class="bottom"></div>
                        </div>
                        <img id="playerimage" src="">
                        <div id="playername" class="stroke">
                        </div>
                        <div class="play button">
                            <div></div>
                            <img src="img/common/spinner.gif" alt="">
                        </div>
                        <div id="create-new">
                            <span><span>o</span> crear uno nuevo</span>
                        </div>
                    </article>
                    <article id="confirmation">
                        <h1>
                            <span class="left-ornament"></span>
                            ¿Esta seguro que lo quiere borrar?
                            <span class="right-ornament"></span>
                        </h1>
                        <p>
                            Todo el progreso se perderá.<br>
                            ¿Esta seguro que lo quiere borrar?
                        </p>
                        <div class="delete button"></div>
                        <div id="cancel">
                            <span>Cancelar</span>
                        </div>
                    </article>
                    <article id="credits">
                        <h1>
                            <span class="left-ornament"></span>
                            <span class="title">
                                Programado en 24h por <a target="_blank" class="stroke clickable" href="http://www.littleworkshop.fr/">Draka</a>
                            </span>
                            <span class="right-ornament"></span>
                        </h1>
                        <div id="authors">
                            <div id="guillaume">
                                <div class="avatar"></div>
                                Juan Martínez
                                <a class="stroke clickable" href="mailto:juan.mar@gmail.com">juan.mar@gmail.com</a>
                            </div>
                            <div id="franck">
                                <div class="avatar"></div>
                                Twitter
                                <a class="stroke clickable" target="_blank" href="http://twitter.com/srdraka">@SrDraka</a>
                            </div>
                        </div>
                        <div id="close-credits">
                            <span>- click para cerrar -</span>
                        </div>
                    </article>
                    <article id="about">
                        <h1>
                            <span class="left-ornament"></span>
                            <span class="title">
                                Que es Wayra Quest?
                            </span>
                            <span class="right-ornament"></span>
                        </h1>
                        <p id="game-desc">
                            Wayra Quest es un demo multiplayer para interactuar con las locadidades agregadas, puedes hablar y seguramente en un futuro jugar.
                        </p>
                        <div class="left">
                            <div class="img"></div>
                            <p>
                                Esta echo en HTML5 y basado en BrowserQuest.
                            </p>
                            <span class="link">
                                <span class="ext-link"></span>
                                <a target="_blank" class="clickable" href="http://hacks.mozilla.org/2012/03/browserquest/">Leer más</a> acerca de BrowserQuest
                            </span>
                        </div>
                        <div class="right">
                            <div class="img"></div>
                            <p>
                                Wayra Quest esta disponible en Firefox, Chrome, Safari, iOS y Android.
                            </p>
                            <span class="link">
                                <span class="ext-link"></span>
                                <a target="_blank" class="clickable" href="https://github.com/Draka/wayraquest">Descargar el codigo</a> en Github
                            </span>
                        </div>
                        <div id="close-about">
                            <span>- click para cerrar -</span>
                        </div>
                    </article>
                    <article id="death">
                        <p>Estas muerto...</p>
                        <div id="respawn" class="button"></div>
                    </article>
                    <article id="error">
                        <h1>
                            <span class="left-ornament"></span>
                            Your browser cannot run Wayra Quest!
                            <span class="right-ornament"></span>
                        </h1>
                        <p>
                            We're sorry, but your browser does not support WebSockets.<br>
                            In order to play, we recommend using the latest version of Firefox, Chrome or Safari.
                        </p>
                    </article>
                </div>
                <div class="parchment-right"></div>
            </section>
        </div>
        <div id="container">
            <div id="canvasborder">
                <article id="instructions" class="clickable">
                    <div class="close"></div>
                    <h1>
                        <span class="left-ornament"></span>
                        Instrucciones
                        <span class="right-ornament"></span>
                    </h1>
                    <ul>
                        <li><span class="icon"></span>Click izquierdo para moverte.</li>
                        <li><span class="icon"></span>Presionar ENTER para chat.</li>
                        <li><span class="icon"></span>Tu personaje se guarda automaticamente.</li>
                    </ul>
                    <p>- click para cerrar -</p>
                </article>
                <article id="achievements" class="page1 clickable">
                    <div class="close"></div>
                    <div id="achievements-wrapper">
                        <div id="lists">
                        </div>
                    </div>
                    <div id="achievements-count" class="stroke">
                        Completado
                        <div>
                            <span id="unlocked-achievements">0</span>
                            /
                            <span id="total-achievements"></span>
                        </div> 
                    </div>
                    <nav class="clickable">
                        <div id="previous"></div>
                        <div id="next"></div>
                    </nav>
                </article>
                <div id="canvas">
                    <canvas id="background"></canvas>
                    <canvas id="entities"></canvas>
                    <canvas id="foreground" class="clickable"></canvas>
                </div>
                <div id="bubbles">				
                </div>
                <div id="achievement-notification">
                    <div class="coin">
                        <div id="coinsparks"></div>
                    </div>
                    <div id="achievement-info">
                        <div class="title">Nuevo logro desbloqueado!</div>
                        <div class="name"></div>
                    </div>
                </div>
                <div id="bar-container">
                    <!--					<div id="healthbar">
                                        </div>
                                        <div id="hitpoints">
                                        </div>
                                        <div id="weapon"></div>
                                        <div id="armor"></div>-->
                    <div id="notifications">
                        <div>
                            <span id="message1"></span>
                            <span id="message2"></span>
                        </div>
                    </div>
                    <div id="playercount" class="clickable">
                        <span class="count">0</span> <span>jugadores</span>
                    </div>
                    <div id="barbuttons">
                        <div id="chatbutton" class="barbutton clickable"></div>
                        <div id="achievementsbutton" class="barbutton clickable"></div>
                        <div id="helpbutton" class="barbutton clickable"></div>
                        <div id="mutebutton" class="barbutton clickable active"></div>
                    </div>
                </div>
                <div id="chatbox">
                    <form action="none" method="get" accept-charset="utf-8">
                        <input id="chatinput" class="gp" type="text" maxlength="60">
                    </form>
                </div>
                <div id="population">
                    <div id="instance-population" class="">
                        <span>0</span> <span>jugadores</span> en esta instancia
                    </div>
                    <div id="world-population" class="">
                        <span>0</span> <span>jugadores</span> en total
                    </div>
                </div>
            </div>
        </div>
        <script>
            var addthis_language = "es";
            var addthis_options = 'facebook, delicious, twitter, digg, myspace, google, myaol, favorites, ask, yahoobkm, more';
        </script>

        <script type="text/javascript" src="http://s7.addthis.com/js/200/addthis_widget.js"></script>
        <footer>
            <div id="sharing" class="clickable">
                Compartir en redes<a href="http://www.addthis.com/bookmark.php" style="text-decoration: none;" onmouseout="addthis_close();" onclick="return addthis_open(this, '', 'http://ec2-75-101-168-206.compute-1.amazonaws.com/quest/client/', 'Un recorrido virtual por la academia Wayra');"><img src="http://s7.addthis.com/static/btn/sm-plus.gif" alt="Compartir" align="left" border="0" height="16" width="16" /></a>
            </div>
            <div id="credits-link" class="clickable">
                – <span id="toggle-credits">Creditos</span>
            </div>
        </footer>

        <ul id="page-tmpl" class="clickable" style="display:none">
        </ul>
        <ul>
            <li id="achievement-tmpl" style="display:none">
                <div class="coin"></div>
                <span class="achievement-name">???</span>
                <span class="achievement-description">???</span>
                <div class="achievement-sharing">
                    <a href="" class="twitter"></a>
                </div>
            </li>
        </ul>

        <img src="img/common/thingy.png" alt="" class="preload">

        <div id="resize-check"></div>

        <script type="text/javascript">
            var ctx = document.querySelector('canvas').getContext('2d'),
            parchment = document.getElementById("parchment");
            
            if(!Detect.supportsWebSocket()) {
                parchment.className = "error";
            }
            
            if(ctx.mozImageSmoothingEnabled === undefined) {
                document.querySelector('body').className += ' upscaled';
            }
            
            if(!Modernizr.localstorage) {
                var alert = document.createElement("div");
                alert.className = 'alert';
                alertMsg = document.createTextNode("You need to enable cookies/localStorage to play Wayra Quest");
                alert.appendChild(alertMsg);

                target = document.getElementById("intro");
                document.body.insertBefore(alert, target);
            } else if(localStorage && localStorage.data) {
                parchment.className = "loadcharacter";
            }
        </script>

        <script src="js/lib/log.js"></script>
        <script>
            var require = { waitSeconds: 60 };
        </script>
        <script data-main="js/home" src="js/lib/require-jquery.js"></script>
        <script>
            $(document).ready(function(){

                $(window).resize(function(){

                    // aquí le pasamos la clase o id de nuestro div a centrar (en este caso "caja")
                    $('#map').css({
                        position:'absolute',
                        left: ($(window).width() - $('#map').outerWidth())/2,
                        top: ($(window).height() - $('#map').outerHeight())/2
                    });

                });

                // Ejecutamos la función
                $(window).resize();

            });
        </script>
        <div id="fb-root"></div>
        <script>
            var a=0;
            window.fbAsyncInit = function() {
                FB.init({
                    appId      : '241197065994013',
                    channelUrl : 'http://ec2-75-101-168-206.compute-1.amazonaws.com/quest/client/',
                    status     : true, 
                    cookie     : true,
                    xfbml      : true,
                    oauth      : true
                });
          
                log.debug("waiting...");
                log.debug("waiting...");
          
                // listen for and handle auth.statusChange events
                FB.Event.subscribe('auth.statusChange', function(response) {
                    if (response.authResponse) {
                        // user has auth'd your app and is logged into Facebook
                        FB.api('/me', function(me){
                            if (me.name) {
                                document.getElementById('auth-displayname').innerHTML = me.name;
                                $('#nameinput').val(me.first_name);
                            }
                        })
                        document.getElementById('auth-loggedout').style.display = 'none';
                        document.getElementById('auth-loggedin').style.display = 'block';
                    } else {
                        // user has not auth'd your app, or is not logged into Facebook
                        document.getElementById('auth-loggedout').style.display = 'block';
                        document.getElementById('auth-loggedin').style.display = 'none';
                    }
                });

                // respond to clicks on the login and logout links
                //        document.getElementById('auth-loginlink').addEventListener('click', function(){
                //          FB.login();
                //        });
                document.getElementById('auth-logoutlink').addEventListener('click', function(){
                    FB.logout();
                }); 
          
            };
            (function(d){
                var js, id = 'facebook-jssdk'; if (d.getElementById(id)) {return;}
                js = d.createElement('script'); js.id = id; js.async = true;
                js.src = "//connect.facebook.net/en_US/all.js";
                d.getElementsByTagName('head')[0].appendChild(js);
            }(document));
        </script>
    </body>
</html>